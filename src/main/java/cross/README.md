<p align="center"><img width="100px" src="https://www.easyicon.net/api/resizeApi.php?id=1141864&size=128"></p>

## 交叉熵法
在电能质量样本信息化的情况下，交叉熵法通过量化信息量之间的差异，衡量不同信息源之间的相交程度确定指标的权重大小。
### 一、标准化处理
设m个电能质量观测样本的n项评估指标实测值构成吃屎评估矩阵，考虑到各个指标的含义及量纲不一，为统一指标变化范围，应对其进行标准化处理。
#### 👩‍💻 实现代码
```bash
public static double[] getG(double[] x) {
    double[] g = new double[9];
    g[0] = (x[0] - 7.0) / (0.0 - 7.0);
    g[1] = (x[1] - 0.1) / (1 - 0.1);
    g[2] = (x[2] - 2.0) / (0.0 - 2.0);
    g[3] = (x[3] - 2.0) / (0.0 - 2.0);
    g[4] = (x[4] - 1.0) / (0.0 - 1.0);
    g[5] = (x[5] - 5.0) / (0.0 - 5.0);
    g[6] = (x[6] - 0.2) / (0.0 - 0.2);
    g[7] = (x[7] - 0.7) / (1.0 - 0.7);
    g[8] = (x[8] - 0.6) / (1.0 - 0.6);
    return g;
}
```

#### 🎃 无量纲标准化矩阵
```bash
0.5411	0.0457	0.3786	0.2386	0.3971
0.7737	0.0654	0.4618	0.5396	0.4292
0.5850	0.3200	0.3250	0.1300	0.0850
0.3350	0.2350	0.0250	0.3150	0.2100
0.5270	0.1530	0.3660	0.1740	0.1720
0.6560	0.1440	0.4660	0.3280	0.0860
0.5390	0.2190	0.4100	0.1065	0.0540
0.4433	0.2067	0.3200	0.1333	0.2133
0.5800	0.2825	0.6600	0.2100	0.4575
```
### 二、特征比
求解第i个指标下第j个观测样本的特征比
#### 实现代码
```bash
public static double[][] getE(double[][] g) {
    double[][] e = new double[9][5];
    for (int i = 0; i < 9; i++) {
        double sum = 0;
        for (int j = 0; j < 5; j++) {
            sum += g[i][j];
        }
        for (int j = 0; j < 5; j++) {
            e[i][j] = g[i][j] / sum;
        }
    }
    return e;
}
```
#### 输出特征比矩阵
```bash
0.3380	0.0286	0.2364	0.1490	0.2480
0.3409	0.0288	0.2035	0.2377	0.1891
0.4048	0.2215	0.2249	0.0900	0.0588
0.2991	0.2098	0.0223	0.2813	0.1875
0.3786	0.1099	0.2629	0.1250	0.1236
0.3905	0.0857	0.2774	0.1952	0.0512
0.4057	0.1648	0.3086	0.0802	0.0406
0.3367	0.1570	0.2430	0.1013	0.1620
0.2648	0.1290	0.3014	0.0959	0.2089
```

### 三、求解最优化模型
求观测样本的总加权交叉熵，构造权重的最优化模型并求解。
#### 部分代码
```bash
double den = 0;
for (int i = 0; i < 9; i++) {
    or (int j = 0; j < 5; j++) {
        for (int k = 0; k < 5; k++) {
            den += CrossD.getD(e, i, j, k);
          }
    }
}

double[] w_bi = new double[9];
for (int i = 0; i < 9; i++) {
      double num = 0;
      for (int j = 0; j < 5; j++) {
      for (int k = 0; k < 5; k++) {
      num += CrossD.getD(e, i, j, k);
      }
    }
    w_bi[i] = num / den;
}
// 至此，客观权重值求解完毕。

for (int i = 0; i < 9; i++) {
      System.out.print(String.format("%.4f", w_bi[i]) + "\t");
}
return w_bi;
```

#### 客观权重向量
权值依次对应电压偏差，暂态压降，三相不平衡，电压波动，电压闪变，电压谐波，频率偏差，供电可靠性，服务性指标。
```bash
0.1172	0.1102	0.1248	0.1121	0.0966	0.1333	0.1520	0.0775	0.0763
```
