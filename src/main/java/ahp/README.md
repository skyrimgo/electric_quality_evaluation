<p align="center"><img width="100px" src="https://www.easyicon.net/api/resizeApi.php?id=1141864&size=128"></p>

## 层次分析法(AHP)
### 构造判断矩阵

  假设某个样本共有m个指标，则判断矩阵是一个m*m的矩阵，`m[i][j]`代表第i个指标相对于第j个指标的重要程度。

  标度  | 含义
  ------------- | -------------
  1  | 两个因素相比，具有同等重要性
  3  | 两个因素相比，前者稍微重要
  5  | 两个因素相比，前者明显重要
  7  | 两个因素相比，前者强烈重要
  9  | 两个因素相比，前者极端重要

  易知判断矩阵为正互反矩阵（所有元素大于0，对角线元素互为倒数）。

#### 🐱 实现代码
```bash
double[] w_ahp = {6, 7, 7, 8, 3, 1, 3, 5, 10}
for (int i = 0; i <= 7; i++) {
    for (int j = i + 1; j <= 8; j++) {
    matrix[i][j] = w_ahp[i] / w_ahp[j] * (0.9 + 0.1 * Math.random());
    }
}
for (int k = 0; k < nrV; k++) {
    for (int i = 0; i < nrV; i++) {
        matrix[i][k] = 1.0 / matrix[k][i];
    }
}
```
#### 🍸 输出判断矩阵
```bash
1.000	0.795	0.845	0.733	1.889	5.584	1.833	1.112	0.558
1.257	1.000	0.988	0.843	2.276	6.588	2.257	1.358	0.668
1.183	1.012	1.000	0.857	2.234	6.374	2.220	1.273	0.699
1.365	1.186	1.167	1.000	2.657	7.718	2.606	1.551	0.757
0.529	0.439	0.448	0.376	1.000	2.993	0.930	0.595	0.286
0.179	0.152	0.157	0.130	0.334	1.000	0.300	0.191	0.090
0.545	0.443	0.450	0.384	1.076	3.332	1.000	0.581	0.276
0.899	0.737	0.785	0.645	1.681	5.246	1.721	1.000	0.479
1.793	1.497	1.430	1.321	3.490	11.100	3.628	2.087	1.000
```
### 求解主观权重向量
最大特征值的特征向量归一化。
#### 🐔 实现代码
```bash
EigenDecomposition evd = new EigenDecomposition(new Array2DRowRealMatrix(matrix));
double sum = 0;
double[] res = new double[9];
for (int i = 0; i < 1; i++) {
    RealVector v = evd.getEigenvector(i);
    for (double d : v.toArray()) {
        sum += d;
    }
    for (double xx : v.toArray()) {
        System.out.print(String.format("%.4f", xx / sum) + "\t");
    }
    for (int j = 0; j < 9; j++) {
        res[j] = v.toArray()[j] / sum;
    }
    System.out.println();
}
```
#### 💪 输出主观权重向量
权值依次对应电压偏差，暂态压降，三相不平衡，电压波动，电压闪变，电压谐波，频率偏差，供电可靠性，服务性指标。

这里采用特征向量法，最大特征值对应的特征向量归一化即为所求：
```bash
主观权重向量：
0.1137	0.1372	0.1356	0.1586	0.0599	0.0200	0.0617	0.1030	0.2102
```
#### 👩‍💻 一致性检验
当一致性比例CR<0.1时，是可以接受的，否则应对判断矩阵作适当修正。
```bash
一致性指标: 5.195743396000374E-4

一致性比例: 0.034870761046982376%
```
判断矩阵的一致性<10%,可以接受。

---
- 👩‍💻 [返回首页](https://github.com/skyrimgo/electric_quality_evaluation/blob/master/README.md)
